name: Run Py GenerateLabels

on:
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      name:
        # Friendly description to be shown in the UI instead of 'name'
        description: "Generate labels"

  pull_request:

jobs:
  generate_labels:
    runs-on: ubuntu-latest
    environment: labels
    steps:
      - name: Get branch names
        id: branch-name
        uses: tj-actions/branch-names@v6

      - name: Checkout repo content
        uses: actions/checkout@v3
        with:
          ref: ${{ steps.branch-name.outputs.head_ref_branch }}

      - name: Setup python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10" # install the python version needed

      - name: Install python packages
        run: |
          python -m pip install --upgrade pip
        shell: bash

      - name: Execute py script
        id: generate_labels
        run: python .github/scripts/GenerateLabels.py
        shell: bash

      - run: echo ${{ steps.generate_labels.outputs.list_directory }}


  call-workflow-passing-data:
      uses: deMartiniFrancesco/INI-5BI-DeMartiniFrancesco-2022-2023/.github/workflows/run_save_labels.yml@master
      with:
        dir_list: ${{ steps.generate_labels.outputs.list_directory }}
